- name: Create a new basic compute instance configuration that only has launch_details and VNIC configuration
  oci_compute_management_instance_configuration:
    compartment_id: "{{test_compartment_ocid}}"
    name: "{{test_instance_pool_instance_configuration_name}}"
    instance_details:
      instance_type: "compute"
      launch_details:
        compartment_id: "{{test_compartment_ocid}}"
        create_vnic_details:
          assign_public_ip: True
          display_name: "{{test_instance_name}}"
          skip_source_dest_check: False
        display_name: "{{test_instance_name}}"
        shape: "{{ test_instance_shape }}"
        source_details:
          source_type: "image"
          image_id: "{{image_ocid}}"
        freeform_tags: "{{ test_default_freeform_tags }}"
  register: result

- set_fact:
    dependency_instance_configuration_id: "{{result.instance_configuration.id}}"